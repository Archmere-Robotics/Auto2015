#pragma config(Hubs,  S1, HTMotor,  HTServo,  none,     none)
#pragma config(Hubs,  S2, HTMotor,  HTMotor,  none,     none)
#pragma config(Sensor, S4,     HTSMUX,         sensorI2CCustom)
#pragma config(Motor,  motorA,          sweeperA,       tmotorNXT, PIDControl, encoder)
#pragma config(Motor,  motorB,          sweeperB,       tmotorNXT, PIDControl, encoder)
#pragma config(Motor,  motorC,          heartbeat,     tmotorNXT, openLoop, encoder)
#pragma config(Motor,  mtr_S1_C1_1,     wheelC,        tmotorTetrix, PIDControl, reversed, encoder)
#pragma config(Motor,  mtr_S1_C1_2,     wheelD,        tmotorTetrix, PIDControl, reversed, encoder)
#pragma config(Motor,  mtr_S2_C1_1,     wheelB,        tmotorTetrix, PIDControl, reversed, encoder)
#pragma config(Motor,  mtr_S2_C1_2,     wheelA,        tmotorTetrix, PIDControl, reversed, encoder)
#pragma config(Motor,  mtr_S2_C2_1,     collectorMotor, tmotorTetrix, openLoop)
#pragma config(Motor,  mtr_S2_C2_2,     liftMotor,     tmotorTetrix, PIDControl, reversed, encoder)
#pragma config(Servo,  srvo_S1_C2_1,    servo1,               tServoNone)
#pragma config(Servo,  srvo_S1_C2_2,    servo2,               tServoNone)
#pragma config(Servo,  srvo_S1_C2_3,    rightHook,            tServoStandard)
#pragma config(Servo,  srvo_S1_C2_4,    dumpServo,            tServoStandard)
#pragma config(Servo,  srvo_S1_C2_5,    rightIRServo,         tServoStandard)
#pragma config(Servo,  srvo_S1_C2_6,    leftIRServo,          tServoStandard)
//*!!Code automatically generated by 'ROBOTC' configuration wizard               !!*//
#include "Auto2015.h"
void init(){
	action("Initializing...");

	//action("-Checking battery:");
	//scrollText("  Ext: %2.1f",externalBatteryAvg/1000);
	//if(externalBatteryAvg==-1)
	//	error("EXT BATTERY DISCONNECTED");
	//else if(externalBatteryAvg<EXT_LOW)
	//	error("EXT BATTERY LOW");
	//scrollText("  NXT: %2.1f",nAvgBatteryLevel/1000);
	//if(nAvgBatteryLevel<NXT_LOW)
	//	error("NXT BATTERY LOW");

	action("-Resetting encoders...");
	nMotorEncoder[wheelA]=0;
	nMotorEncoder[wheelB]=0;
	nMotorEncoder[wheelC]=0;
	nMotorEncoder[wheelD]=0;
	nMotorEncoder[liftMotor]=0;
	action("  Done");
	action("-Init. Servos...");
	servoChangeRate[dumpServo]=1;
	servo[dumpServo]=HOLD_POS;
	servo[rightHook]=RIGHT_HOOK_DOWN;
	raiseIR();
	action("  Done");
	wait1Msec(100);
	action("-Raising Lift...");
	raise(LIFT_BOTTOM,false);
	action("  Done");
	wait1Msec(100);
	action("-Done.");
}

void preinit(){
	lowerIR();
}


/*
void knockdownBalls() {
	driveForward(KD_FOREWARD);
	goLeft(KD_LEFT);
	spinRight(KD_SPIN);
}*/

task main() {
	preinit();
	action("Waiting...");
	//waitForStart();
	bDisplayDiagnostics=false;
	init();
	action("Moving to IR...");
	driveForward(FORWARD_DRIVE);
	action("Checking IR...");
	int position=getCenterThingPos();
	lowerIR();
	switch(position) {
	case 1:
		goLeft(ONE_LEFT_DRIVE);
		driveForward(ONE_FORWARD_DRIVE);
		break;
	case 2:
		goLeft(TWO_LEFT);
		spinLeft(TWO_SPIN);
		driveForward(TWO_FORWARD);
		break;
	case 3:
		spinLeft(THREE_SPIN);
		driveForward(THREE_FORWARD);
		// may not need realign for close dump
		break;
	default:
		error("Got bad position.");
		Stop();
		return;
	}
	wait1Msec(250);
	realign();
	tilt();
	raise(HIGH_GOAL,true);
	dump();
	lower();
	bDisplayDiagnostics=true;
	Stop();
	//knockdownBalls();
}
